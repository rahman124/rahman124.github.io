[{"content":"In this blog post I will show you how you can send your emails from Exim to Office 365 via a TLS connector.\nI will discuss the steps that I took to configure this in our environment so that you may have an easier time if you decide to go down the same route aswell. Prerequisites In the Exchange admin center, you will need to have your TLS certificate domain configured as an accepted domain in your Office 365 organisation.\nTo configure an accepted domain, you need to go to the Microsoft 365 admin center, click Settings \u0026gt; Domains and add your domain from there.\nAnd of course you need your TLS certificate to use with the connector. Exchange setup To start, create your connector in the Exchange admin center\nOn the left sidebar click Mail flow \u0026gt; Connectors \u0026gt; Add a connector\nOn the New Connector page, click Your organization\u0026rsquo;s email server for the Connection from, then click Next\nSpecify a name for your connector and description on the Connector name page\nOn the Authenticating sent email page, enter the domain name for your certificate\nOnce done, review the details and if it\u0026rsquo;s all good, click Create connector. You should then see it on the Connectors page. Exim setup As per Microsoft documentation, you need to enable TLS on Exim.\nTo do this, on your exim.conf file set the TLS certificate and key like so\ntls_certificate = /etc/ssl/my-cert.crt tls_privatekey = /etc/ssl/my-key.key \nHowever, we are not done yet. While this will enable TLS on Exim, it is only good for when Exim is acting as a server. In our case we want Exim to act as a client.\nIf we look at the Exim docs part 9\n The tls_certificate and tls_privatekey options of the smtp transport provide the client with a certificate, which is passed to the server if it requests it.\n \nEssentially the global option we specified above is not automatically passed on to the smtp transport.\nIn exim.conf, set the certificate in the smtp transport as such\nremote_smtp: driver = smtp . . . hosts_require_tls = * tls_certificate = /etc/ssl/my-cert.crt tls_privatekey = /etc/ssl/my-key.key I also set hosts_require_tls to force TLS for all outbound mail. All good now! If you send some test emails from Exim, you can check they were sent via our connector by the Exchange admin center.\nOn the admin page, left sidebar, click Reports \u0026gt; Mail flow \u0026gt; Inbound messages report\nHere you can verify that the TLS connector was used, as well as some other stats.\n","permalink":"https://rahman124.github.io/posts/exim-relay-connector/","summary":"In this blog post I will show you how you can send your emails from Exim to Office 365 via a TLS connector.\nI will discuss the steps that I took to configure this in our environment so that you may have an easier time if you decide to go down the same route aswell. Prerequisites In the Exchange admin center, you will need to have your TLS certificate domain configured as an accepted domain in your Office 365 organisation.","title":"Configure a certificate-based connector to relay email from Exim to Office 365"},{"content":"\u0026ldquo;Passion, Vision, Aggression, Mindset\u0026rdquo;\nA driven platform engineer, always looking to grow and develop myself both as an engineer and as an individual.\nMy technical work involves, but not limited to, Microsoft Azure, Network Virtual Appliances, Kubernetes, APM and more. Certifications: Microsoft Certified: Azure Fundamentals\nMicrosoft Certified: Azure Administrator Associate Tech specs This site was built with Hugo using the PaperMod theme.\nHosted using GitHub Pages.\nShoutouts to the creators for the easy and intuitive tools to publish this site.\n","permalink":"https://rahman124.github.io/about/","summary":"\u0026ldquo;Passion, Vision, Aggression, Mindset\u0026rdquo;\nA driven platform engineer, always looking to grow and develop myself both as an engineer and as an individual.\nMy technical work involves, but not limited to, Microsoft Azure, Network Virtual Appliances, Kubernetes, APM and more. Certifications: Microsoft Certified: Azure Fundamentals\nMicrosoft Certified: Azure Administrator Associate Tech specs This site was built with Hugo using the PaperMod theme.\nHosted using GitHub Pages.\nShoutouts to the creators for the easy and intuitive tools to publish this site.","title":"About"}]